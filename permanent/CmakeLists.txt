cmake_minimum_required(VERSION 3.15)
project(permanent_fast)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

list(APPEND CMAKE_PREFIX_PATH "/opt/homebrew")

# Find packages installed via Homebrew
find_package(pybind11 CONFIG REQUIRED)
find_package(Eigen3 REQUIRED NO_MODULE)

# Create the binding module
pybind11_add_module(permanent_fast perm_fast.cpp)

# Link Eigen. 
target_link_libraries(permanent_fast PRIVATE Eigen3::Eigen)

if(NOT CMAKE_BUILD_TYPE MATCHES "Debug")
    target_compile_options(permanent_fast PRIVATE -O3)
endif()